<h1 id="docker">Docker<a aria-hidden="true" class="anchor-heading icon-link" href="#docker"></a></h1>
<h1 id="definition">Definition<a aria-hidden="true" class="anchor-heading icon-link" href="#definition"></a></h1>
<p><a href="https://phoenixnap.com/kb/docker-image-vs-container">Image vs Container</a>  </p>
<h2 id="dockerfiles">Dockerfiles<a aria-hidden="true" class="anchor-heading icon-link" href="#dockerfiles"></a></h2>
<p>Dockerfiles are a set of commands to build an image. Each command in a dockerfile adds a layer to an image.</p>
<h2 id="images">Images<a aria-hidden="true" class="anchor-heading icon-link" href="#images"></a></h2>
<p>Images are immutable snapshots of the current state, and are stored in an arbitrary number of layers.
Images are required to run a container, and are obtained from a source like Docker hub or built with a Dockerfile.</p>
<h2 id="container">Container<a aria-hidden="true" class="anchor-heading icon-link" href="#container"></a></h2>
<p>A container refers to the environment where image layers and a read/write layer exist to run an application.</p>
<h1 id="install">Install<a aria-hidden="true" class="anchor-heading icon-link" href="#install"></a></h1>
<h2 id="ubuntu-server">Ubuntu Server<a aria-hidden="true" class="anchor-heading icon-link" href="#ubuntu-server"></a></h2>
<p><a href="https://docs.docker.com/engine/install/ubuntu/#install-using-the-repository">Link</a></p>
<h2 id="wsl-setup">WSL setup<a aria-hidden="true" class="anchor-heading icon-link" href="#wsl-setup"></a></h2>
<p>Ensure docker desktop is up to date<br>
wsl2 selected in docker desktop<br>
ubuntu installed, instance enabled in docker desktop  </p>
<h3 id="add-user--post-install-setup">Add User / Post Install Setup<a aria-hidden="true" class="anchor-heading icon-link" href="#add-user--post-install-setup"></a></h3>
<pre><code>sudo groupadd docker
sudo usermod -aG docker $USER
newgrp docker
</code></pre>
<h2 id="operations">Operations<a aria-hidden="true" class="anchor-heading icon-link" href="#operations"></a></h2>
<h3 id="list-all-containers">List all containers<a aria-hidden="true" class="anchor-heading icon-link" href="#list-all-containers"></a></h3>
<pre><code>docker ps -a
</code></pre>
<h3 id="filters">Filters<a aria-hidden="true" class="anchor-heading icon-link" href="#filters"></a></h3>
<pre><code>docker ps --filter "name=TEST*" 
</code></pre>
<h3 id="stop-all-containers">Stop all containers<a aria-hidden="true" class="anchor-heading icon-link" href="#stop-all-containers"></a></h3>
<pre><code>docker stop $(docker ps -aq)
</code></pre>
<h3 id="start-a-container">Start a container<a aria-hidden="true" class="anchor-heading icon-link" href="#start-a-container"></a></h3>
<pre><code>docker start CONTAINER [commands]
</code></pre>
<h3 id="restart-policy">Restart Policy<a aria-hidden="true" class="anchor-heading icon-link" href="#restart-policy"></a></h3>
<div class="table-responsive">




















<table><thead><tr><th>Flag</th><th>Description</th></tr></thead><tbody><tr><td>no</td><td>Don't restart</td></tr><tr><td>on-failure[:max:retries]</td><td>restart if error only. retries option is optional.</td></tr><tr><td>unless-stopped</td><td>Like always except not if daemon restarts</td></tr></tbody></table></div>
<h3 id="startup-behaviour">Startup Behaviour<a aria-hidden="true" class="anchor-heading icon-link" href="#startup-behaviour"></a></h3>
<p>Prevent single container from starting on boot
docker update --restart=no   mycontainer</p>
<p>Prevent all containers from starting on boot
docker update --restart=no $(docker ps -aq)</p>
<h3 id="remove-all-containers">Remove all containers<a aria-hidden="true" class="anchor-heading icon-link" href="#remove-all-containers"></a></h3>
<pre><code>docker rm $(docker ps -aq)
</code></pre>
<h3 id="open-terminal-inside-running-container">Open terminal inside running container<a aria-hidden="true" class="anchor-heading icon-link" href="#open-terminal-inside-running-container"></a></h3>
<pre><code>docker exec -it CONTAINER bash
</code></pre>
<h3 id="copy-files-tofrom-volume">Copy files to/from volume<a aria-hidden="true" class="anchor-heading icon-link" href="#copy-files-tofrom-volume"></a></h3>
<p><strong>Mount volume in container as shown but reverse the cp arguments to copy from host to container</strong>
docker run \<br>
-v VOLUME:/dir \<br>
--name copier -d hello-world \<br>
docker cp copier:/dif/path /home/PATH<br>
docker rm copier  </p>
<h3 id="update-all-images">Update all images<a aria-hidden="true" class="anchor-heading icon-link" href="#update-all-images"></a></h3>
<p>docker images | grep -v ^REPO | sed 's/ +/:/g' | cut -d: -f1,2 | xargs -L1 docker pull</p>
<hr>
<strong>Backlinks</strong>
<ul>
<li><a href="/notes/enjb2w7wdyo2wyg7ek23500">Frappe Framework</a></li>
<li><a href="/notes/qfhatiojg542x6a4yprmtz8">Debian</a></li>
</ul>